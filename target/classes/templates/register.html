<!DOCTYPE html>
<html lang="tr" xmlns:th="https://www.thymeleaf.org">
<head>
    <title>Kayıt Ol</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .container h2 {
            text-align: center;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        .form-group button {
            width: 100%;
            padding: 8px;
            border: none;
            background-color: #4caf50;
            color: #fff;
            cursor: pointer;
            border-radius: 4px;
        }

        .form-group button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
<div class="container">
    <div>
        <h2>Kayıt Ol</h2>
    </div>
    <div th:if="${message}">
        <p th:text="${message}"></p>
    </div>
    <form>
        <div class="form-group">
            <label for="name">İsim:</label>
            <input type="text" name="name" id="name" required>
        </div>
        <div class="form-group">
            <label for="surname">Soyisim:</label>
            <input type="text" name="surname" id="surname" required>
        </div>
        <div class="form-group">
            <label for="username">Mail:</label>
            <input type="email" id="username" name="username" required>
        </div>
        <div class="form-group">
            <label for="password">Şifre:</label>
            <input type="password" name="password" id="password" required>
        </div>
        <div class="form-group">
            <label for="passwordAgain">Şifre Tekrar:</label>
            <input type="password" name="passwordAgain" id="passwordAgain" required>
        </div>
        <div class="form-group">
            <button type="submit">Kayıt Ol</button>
        </div>
    </form>
</div>

</body>

<script>
    $(document).ready(function () {
        $('#registerForm').submit(function (event) {
            event.preventDefault();
            const username = $('#name input').val();
            const surname = $('#surname input').val();
            const email = $('#username input').val();
            const password = $('#password input').val();
            const passwordConfirm = $('#passwordAgain input').val();

            // Check if passwords match
            if (password !== passwordConfirm) {
                alert("Şifreler eşleşmiyor.");
                return;
            }

            // Register user
            const user = {
                "firstName": username.toString(),
                "lastName": surname.toString(),
                "email": email.toString(),
                "password": password.toString(),
                "repeatPassword": passwordConfirm.toString()
            };
            $.ajax({
                type: "POST",
                contentType: "application/json",
                url: "http://localhost:8080/admin/register-new",
                data: JSON.stringify(user),
                dataType: 'json',
                cache: false,
                timeout: 600000,
                success: function () {
                    window.location.href = "http://localhost:8080/admin/login"; // route
                }
            })

        });
    });


</script>
</html>